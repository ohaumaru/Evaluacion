/*
Created: 29/05/2023
Modified: 29/05/2023
Model: Microsoft SQL Server 2012
Database: MS SQL Server 2012
*/


-- Create tables section -------------------------------------------------

-- Table TIPO_INFORMACION

CREATE TABLE [TIPO_INFORMACION]
(
 [COD_TIPO_INFORMACION] Int IDENTITY NOT NULL,
 [NOMBRE_TIPO_INFO] Nvarchar(1) NOT NULL
)
go

-- Add keys for table TIPO_INFORMACION

ALTER TABLE [TIPO_INFORMACION] ADD CONSTRAINT [PK_TIPO_INFORMACION] PRIMARY KEY ([COD_TIPO_INFORMACION])
go

-- Table PROYECTO

CREATE TABLE [PROYECTO]
(
 [COD_PROYECTO] Int IDENTITY NOT NULL,
 [NOMBRE_PROYECTO] Nvarchar(1) NOT NULL
)
go

-- Add keys for table PROYECTO

ALTER TABLE [PROYECTO] ADD CONSTRAINT [PK_PROYECTO] PRIMARY KEY ([COD_PROYECTO])
go

-- Table TIPO

CREATE TABLE [TIPO]
(
 [COD_TIPO] Int IDENTITY NOT NULL,
 [NOMBRE_TIPO] Nvarchar(1) NOT NULL
)
go

-- Add keys for table TIPO

ALTER TABLE [TIPO] ADD CONSTRAINT [PK_TIPO] PRIMARY KEY ([COD_TIPO])
go

-- Table PRODUCTO

CREATE TABLE [PRODUCTO]
(
 [COD_PRODUCTO] Int IDENTITY NOT NULL,
 [DESCRIP_PRODUCTO] Nvarchar(1) NOT NULL
)
go

-- Add keys for table PRODUCTO

ALTER TABLE [PRODUCTO] ADD CONSTRAINT [PK_PRODUCTO] PRIMARY KEY ([COD_PRODUCTO])
go

-- Table PRODUCTO-PROYECTO

CREATE TABLE [PRODUCTO-PROYECTO]
(
 [COD_PROYECTO] Int NOT NULL,
 [COD_PRODUCTO] Int NOT NULL
)
go

-- Add keys for table PRODUCTO-PROYECTO

ALTER TABLE [PRODUCTO-PROYECTO] ADD CONSTRAINT [PK_PRODUCTO-PROYECTO] PRIMARY KEY ([COD_PROYECTO],[COD_PRODUCTO])
go

-- Table MENSAJE

CREATE TABLE [MENSAJE]
(
 [COD_MENSAJE] Int IDENTITY NOT NULL,
 [COD_PROYECTO] Int NULL,
 [COD_PRODUCTO] Int NULL,
 [COD_FORMATO] Int NULL
)
go

-- Create indexes for table MENSAJE

CREATE INDEX [IX_Relationship6] ON [MENSAJE] ([COD_PROYECTO],[COD_PRODUCTO])
go

CREATE INDEX [IX_Relationship9] ON [MENSAJE] ([COD_FORMATO])
go

-- Add keys for table MENSAJE

ALTER TABLE [MENSAJE] ADD CONSTRAINT [PK_MENSAJE] PRIMARY KEY ([COD_MENSAJE])
go

-- Table FORMATO_MENSAJE

CREATE TABLE [FORMATO_MENSAJE]
(
 [COD_FORMATO] Int IDENTITY NOT NULL,
 [NOMBRE_FORMATO_MENSAJE] Nvarchar(1) NOT NULL,
 [REMITENTE] Nvarchar(1) NOT NULL,
 [ASUNTO] Nvarchar(1) NOT NULL,
 [COD_TIPO_INFORMACION] Int NULL,
 [COD_TIPO] Int NULL
)
go

-- Create indexes for table FORMATO_MENSAJE

CREATE INDEX [IX_Relationship7] ON [FORMATO_MENSAJE] ([COD_TIPO_INFORMACION])
go

CREATE INDEX [IX_Relationship8] ON [FORMATO_MENSAJE] ([COD_TIPO])
go

-- Add keys for table FORMATO_MENSAJE

ALTER TABLE [FORMATO_MENSAJE] ADD CONSTRAINT [PK_FORMATO_MENSAJE] PRIMARY KEY ([COD_FORMATO])
go

-- Create foreign keys (relationships) section ------------------------------------------------- 


ALTER TABLE [PRODUCTO-PROYECTO] ADD CONSTRAINT [Relationship4] FOREIGN KEY ([COD_PROYECTO]) REFERENCES [PROYECTO] ([COD_PROYECTO]) ON UPDATE NO ACTION ON DELETE NO ACTION
go



ALTER TABLE [PRODUCTO-PROYECTO] ADD CONSTRAINT [Relationship5] FOREIGN KEY ([COD_PRODUCTO]) REFERENCES [PRODUCTO] ([COD_PRODUCTO]) ON UPDATE NO ACTION ON DELETE NO ACTION
go



ALTER TABLE [MENSAJE] ADD CONSTRAINT [Relationship6] FOREIGN KEY ([COD_PROYECTO], [COD_PRODUCTO]) REFERENCES [PRODUCTO-PROYECTO] ([COD_PROYECTO], [COD_PRODUCTO]) ON UPDATE NO ACTION ON DELETE NO ACTION
go



ALTER TABLE [FORMATO_MENSAJE] ADD CONSTRAINT [Relationship7] FOREIGN KEY ([COD_TIPO_INFORMACION]) REFERENCES [TIPO_INFORMACION] ([COD_TIPO_INFORMACION]) ON UPDATE NO ACTION ON DELETE NO ACTION
go



ALTER TABLE [FORMATO_MENSAJE] ADD CONSTRAINT [Relationship8] FOREIGN KEY ([COD_TIPO]) REFERENCES [TIPO] ([COD_TIPO]) ON UPDATE NO ACTION ON DELETE NO ACTION
go



ALTER TABLE [MENSAJE] ADD CONSTRAINT [Relationship9] FOREIGN KEY ([COD_FORMATO]) REFERENCES [FORMATO_MENSAJE] ([COD_FORMATO]) ON UPDATE NO ACTION ON DELETE NO ACTION
go




